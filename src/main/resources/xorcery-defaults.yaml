id: "{{ ENV.SERVER_ID | host}}"
name: genericserver
host: localhost
environment: development
tag: default

home: "{{ ENV.XORCERY_HOME | SYSTEM.user_dir }}"
build_resources: "{{ home }}/target/classes"
resources: "{{ ENV.RESOURCES | build_resources }}"

idle_timeout: -1

server:
  scheme: "{{ server.ssl.enabled ? \"https\" | \"http\" }}"
  port: "{{ server.ssl.enabled ? server.ssl.port | server.http.port }}"
  uri: "{{server.scheme}}://{{host}}:{{server.port}}/"

  idle_timeout: "{{ idle_timeout }}"

  http:
    port: 8889

  http2:
    enabled: true

  http3:
    enabled: false
    port: "{{ server.ssl.port }}"

  ssl:
    enabled: true
    port: 8443
    trustall: true
    wantclientauth: true
    snirequired: false
    snihostcheck: false
    keystore:
      type: "PKCS12"
      path: "{{ resources }}/keystore.p12"
      password: "password"
    truststore:
      type: "PKCS12"
      path: "{{ resources }}/truststore.jks"
      password: "password"

client:
  http2:
    enabled: true

  http3:
    enabled: true

  ssl:
    enabled: true
    trustall: true
    keystore:
      type: "PKCS12"
      path: "{{ resources }}/keystore.p12"
      password: "password"
    truststore:
      type: "PKCS12"
      path: "{{ resources }}/truststore.jks"
      password: "password"

jaxrs:
  register:
    - com.exoreaction.xorcery.service.registry.RegistryService$Feature
  packages:
    - com.exoreaction.xorcery.jaxrs
    - com.exoreaction.xorcery.server.resources
    - com.exoreaction.xorcery.service

reactivestreams:
  allowlocal: false

registry:
  master: "{{ server.uri }}"
  dnsdiscovery: false

conductor:
  templates: []
#    - /conductor/metrics.yaml
#    - /conductor/metrics_opensearch.yaml
#    - /conductor/logging_opensearch.yaml
#    - /conductor/requestlog_opensearch.yaml
#    - /conductor/certmanager.yaml

certificatemanager:
  is_master: true
  renew_on_startup: true

# Logging
log4jappender: {}

soutlogging: {}

logs: {}

requestlog: {}

# Metrics
metrics: {}

soutmetrics: {}

jmxmetrics: {}

# Domain events
neo4jdatabase:
  path: "{{ home }}/neo4j"
  settings:
    dbms:
      allow_upgrade: true

neo4jprojections: {}

eventstore:
  url: "esdb://{{ ENV.EVENTSTORE_HOST | \"localhost\" }}:2113?tls=false"

opensearch:
  url: "http://{{ ENV.OPENSEARCH_HOST | \"localhost\" }}:9200"
  component_templates: {}
  index_templates: {}

domainevents: {}

# Misc
visualizer: {}
